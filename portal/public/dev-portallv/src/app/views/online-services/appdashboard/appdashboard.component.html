<div class="row">
  <div class="col-xl-12">
    <div class="breadcrumb-holder">
      <h1 class="main-title float-left">Dashboard</h1>
      <ol class="breadcrumb float-left">

        <a href="#/online-dashboard/app-services" ><li class="fa fa-dashboard">Main Dashboard</li></a> &nbsp;

      </ol>
      <div class="clearfix">
        <dx-button
          text= "{{app_renewalduenotifications}} Application Due for Renewal"
          type="default"
          icon="fa fa-eraser"
          [elementAttr]="{ id: 'elementId', class: 'pull-right' }"
          (onClick)="onLoadApplicationDetailsDueforRenewal()">
      </dx-button>
      </div>
    </div>
  </div>
</div>
<div class="row">
  <!-- Content Header (Page header) -->
  
  <div class="col-xs-12 col-md-6 col-lg-6 col-xl-2_5 div-nopadding">
    <div class="card-box noradius noborder bg-warning">
      <i class="fa fa-product-hunt float-right text-white"></i>
      <h6 class="text-white text-uppercase m-b-20">PENDING SUBMISSION</h6>
      <h1 class="m-b-20 text-white counter">{{pending_submission}}</h1>
    </div>
    <div class="card-box noradius noborder bg-warning">

      <span ><a  class=" " (click) ="OnViewApplicationSubmissionsStatus('1')"  class="reg_routerlink ">View Pending Submission</a></span>
    </div>
  </div>
  <div class="col-xs-12 col-md-6 col-lg-6 col-xl-2_5 div-nopadding">
    <div class="card-box noradius noborder bg-default">
      <i class="fa fa-building float-right text-white"></i>
      <h6 class="text-white text-uppercase m-b-20">INVOICES PENDING PAYMENT</h6>
      <h1 class="m-b-20 text-white counter">{{invoiced_pendingpayment}}</h1>
     
    </div>
    <div class="card-box noradius noborder bg-default">
      <span ><a (click) ="OnViewApplicationSubmissionsStatus('4')"  class="reg_routerlink ">View Invoiced Applications</a></span>
      </div>
  </div>

  <div class="col-xs-12 col-md-6 col-lg-6 col-xl-2_5 div-nopadding">
    <div class="card-box noradius noborder bg-danger">
      <i class="fa fa-question-circle float-right text-white"></i>
      <h6 class="text-white text-uppercase m-b-20">QUERIED APPLICATIONS</h6>
      <h1 class="m-b-20 text-white counter">{{queried_applications}}</h1>
      
    </div>
    <div class="card-box noradius noborder bg-danger">
      <span class=""><a (click) ="OnViewApplicationSubmissionsStatus('6,7,8,9')"   class="reg_routerlink ">View Queried Applications</a></span>
    </div>
  </div>

  <div class="col-xs-12 col-md-6 col-lg-6 col-xl-2_5 div-nopadding">
    <div class="card-box noradius noborder bg-success">
      <i class="fa fa-ban float-right text-white"></i>
      <h6 class=" text-white text-uppercase m-b-20">APPROVED APPLICATIONS</h6>
      <h1 class="m-b-20 text-white counter">{{approved_applications}}</h1>
       
    </div>
    <div class="card-box noradius noborder bg-success ">
      <span class=""><a (click) ="OnViewApplicationSubmissionsStatus('10')"  class="reg_routerlink">View Approved Applications</a></span>
    </div>
  </div>
  <div class="col-xs-12 col-md-6 col-lg-6 col-xl-2_5 div-nopadding">
    <div class="card-box noradius noborder bg-danger">
      <i class="fa fa-file-text-o float-right text-white"></i>
      <h6 class=" text-white text-uppercase m-b-20">REJECTED APPLICATIONS</h6>
      <h1 class="m-b-20 text-white counter">{{rejected_applications}}</h1>
        
    </div>
    <div class="card-box noradius noborder bg-danger">
      <span class="col-lg-12"><a (click) ="OnViewApplicationSubmissionsStatus('11')"  class="reg_routerlink">View Rejected Applications</a></span>
    </div>
  </div>
</div>
<!-- Main row -->
<div class="row div-nopadding">
  <!-- Left col -->
  <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 col-xl-12 div-nopadding" >
    <div class="card mb-3"  style="height: 800px;overflow-y:auto !important;">
     
        <div class="card-header">
            <h6><i class="fa fa-line-chart"></i>Application processing</h6>
            Application processing pending approval.
          </div>
          <div class="card-body no-padding" style="max-height: 700px;min-height: 260px;overflow-y:auto !important;">
              <form role="form" class="row" enctype="multipart/form-data" role="form" [formGroup]="FilterDetailsFrm">
                <div class="col-lg-3 no-padding">
                    <dx-select-box  [dataSource]="modulesData" valueExpr="id" displayExpr="name" 
                    (onSelectionChanged)="onSelectModuleApplicationFilters($event)"   [searchEnabled]="true" placeholder="Select Application Type " formControlName="module_id">
                    </dx-select-box>
                </div>
                <div class="col-lg-3 no-padding">
                  <dx-select-box  [dataSource]="subModuleData" valueExpr="id" displayExpr="name" 
                  (onSelectionChanged)="onSelectApplicationFilters($event)"   [searchEnabled]="true" placeholder="Select Application Sub-Type " formControlName="sub_module_id">
                  </dx-select-box>
              </div>
              <div class="col-lg-3 no-padding">
                  <dx-select-box  [dataSource]="sectionsData" valueExpr="id" displayExpr="name" 
                  (onSelectionChanged)="onSelectApplicationFilters($event)"   [searchEnabled]="true" placeholder="Select Application Category" formControlName="section_id">
                  </dx-select-box>
              </div>
              <div class="col-lg-3 no-padding">
                  <dx-button
                    text="Clear Filter"
                    type="danger"
                    icon="fa fa-eraser"
                    [elementAttr]="{ id: 'elementId', class: 'pull-right' }"
                    (onClick)="onClearProdutFilters()">
                </dx-button>
        
              </div>
        </form>
        
            <dx-data-grid class="table row-border hover"  [dataSource]="dtAppsnProcessesData" keyExpr="ID">
              <dxo-filter-row [visible]="false"></dxo-filter-row>
              <dxo-search-panel [visible]="true">
              </dxo-search-panel>
              <dxo-paging [enabled]="true" [pageSize]="100"></dxo-paging>
              
              <dxo-pager [showPageSizeSelector]="true" [allowedPageSizes]="[5, 10, 20,100]" [showInfo]="true">
              </dxo-pager>
              <dxo-export [enabled]="true" fileName="dtAppsnProcessesData" [allowExportSelectedData]="true"></dxo-export>
  
              <dxo-group-panel [visible]="true"></dxo-group-panel>
              <dxi-column [width] = 130 name="command-editing" [allowFiltering]="false" [allowSorting]="true" cellTemplate="cellTemplate">
                <div *dxTemplate="let data of 'cellTemplate'">
                    
                    <dx-button text="Preview" (click)="funcViewApplicationProcessing(data)"
                      type="success" icon="a fa-edit">
                    </dx-button>
                </div>
              </dxi-column>
              <dxi-column dataField="tracking_no" ></dxi-column>
              <dxi-column dataField="reference_no" ></dxi-column>
              <dxi-column [groupIndex]="0" dataField="module_name"></dxi-column>
              <dxi-column [groupIndex]="1"  dataField="application_type"></dxi-column>
              <dxi-column dataField="section"></dxi-column>
             
              <dxi-column dataField="current_process" caption="Current Process"></dxi-column>
              <dxo-group-panel [visible]="true"></dxo-group-panel>
              <dxo-grouping #expand [autoExpandAll]="true"></dxo-grouping>
            </dx-data-grid>
          </div>
    </div><!-- end card-->
  </div>
 <!--
  <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 col-xl-12 div-nopadding">
    <div class="card mb-3 div-nopadding">
      <div class="card-header">
        <h6><i class="fa fa-envelope-o"></i> Latest Notifications</h6>
        Lastest notifications on application(s) processing
      </div>
      <div class="card-body div-nopadding">

        <div class="widget-messages nicescroll div-nopadding" style="max-height: 350px;min-height: 250px;">
          <dx-data-grid class="table row-border hover" [height]= 450  [remoteOperations]='true' [dataSource]="dtaApplicationNotifications" keyExpr="ID">
            <dxo-filter-row [visible]="false"></dxo-filter-row>
            <dxo-search-panel [visible]="true">
            </dxo-search-panel>
            <dxo-paging [enabled]="true" [pageSize]="10"></dxo-paging>
  
            <dxo-selection mode="single"></dxo-selection>
            <dxo-pager [showPageSizeSelector]="true" [allowedPageSizes]="[5, 10, 20]" [showInfo]="true">
            </dxo-pager>
            <dxo-export [enabled]="true" fileName="applicationNotifications" [allowExportSelectedData]="true"></dxo-export>
            <dxi-column name="command-editing" [width] = 80  [allowFiltering]="false" [allowSorting]="false" cellTemplate="cellTemplate">
                <div *dxTemplate="let data of 'cellTemplate'">
                
                <a (click)="funcPreviewApplicationNotification(data)"  class=" action-btn" ><i class="fa fa-edit"></i>Preview</a>
              </div>
              </dxi-column>
            <dxi-column dataField="subject"></dxi-column>

            <dxi-column name="command-editing" [width] = 180   [allowFiltering]="false" [allowSorting]="false" cellTemplate="cellTemplateMsg">
                <div *dxTemplate="let data of 'cellTemplateMsg'">
                    <div [innerHTML]="data.data.message"></div>
                </div>
              </dxi-column> 
            <dxi-column dataField="sent_on"></dxi-column>
          </dx-data-grid>
        </div>

      </div>
     
    </div>
  </div>
  end card-->
</div>
<dx-popup class="popup" [width]="funcpopWidth(80)" [height]="450" [showTitle]="true" title="Preview Product Application Processing"
  [dragEnabled]="false" [closeOnOutsideClick]="true" [(visible)]="isPreviewApplicationProcessing">

  <div *dxTemplate="let data of 'content'" style="background:#fff;">
      <div class="row">
        <dx-data-grid class="table row-border hover div-backwhite" [height]= 380 [columnHidingEnabled]="false" [dataSource]="productApplicationProcessingData"
        [showBorders]="true" [allowColumnResizing]="true" keyExpr="id">
        <dxo-filter-row [visible]="false"></dxo-filter-row>
        <dxo-load-panel [enabled]="true">
        </dxo-load-panel>
        <dxo-paging [enabled]="true">
        </dxo-paging>
        <dxo-pager [showPageSizeSelector]="true" [allowedPageSizes]="[10, 20]" [showNavigationButtons]="true" [showInfo]="true"
          infoText="Page #{0}. Total: {1} ({2} items)">
        </dxo-pager>
        <dxo-search-panel [visible]="true">
        </dxo-search-panel>
        <dxo-export [enabled]="true" fileName="ProductApplications" [allowExportSelectedData]="true"></dxo-export>
  
        <dxo-selection mode="single"></dxo-selection>
        <dxi-column width=120 dataField="tracking_no"></dxi-column>
        <dxi-column width=120  dataField="reference_no"></dxi-column>
        <dxi-column dataField="process_name"></dxi-column>
        <dxi-column  dataField="prev_stage"></dxi-column>
        <dxi-column  dataField="current_stage"></dxi-column>
        <dxi-column   dataField="processing_date"></dxi-column>
       
        <dxo-grouping #expand [autoExpandAll]="true"></dxo-grouping>
      </dx-data-grid> 
      </div>
  </div>
</dx-popup>

<dx-popup class="popup" [width]="funcpopWidth(90)" [height]="700" [showTitle]="true" title="{{printReportTitle}}"
  [dragEnabled]="false" [closeOnOutsideClick]="true" [(visible)]="isPrintReportVisible">
  <div *dxTemplate="let data of 'content'">
      <div class="col-lg-12 row" [innerHTML]="printiframeUrl | safe: 'html'"></div>
  </div>
</dx-popup>

<dx-popup class="popup"  [width]="funcpopWidth(40)" [height]="450" [showTitle]="true" title="Preview Application Notification"
  [dragEnabled]="false" [closeOnOutsideClick]="true" [(visible)]="isPreviewApplicationNotification">
  <div *dxTemplate="let data of 'content'" style="background:#fff;">
    <form role="form" class="col-lg-12" enctype="multipart/form-data" role="form" [formGroup]="frmPreviewApplicationNotification">
      <div class="row">
          
          <div class="col-lg-12">
            <label class="control-label">Subject</label>
            <dx-text-box formControlName="subject" readOnly=true >
            </dx-text-box>
          </div>
          <div class="col-lg-12 ">
            <label for="ti" class="control-label">Message</label>
            
              <dx-html-editor [height]="200" readOnly ="true"  formControlName="message"  placeholder="Message">
                  <dxo-toolbar>
                      <dxi-item formatName="separator"></dxi-item>
                      <dxi-item formatName="size" [formatValues]="['8pt', '10pt', '12pt', '14pt', '18pt', '24pt', '36pt']"></dxi-item>
                      <dxi-item formatName="font" [formatValues]="['Arial', 'Courier New', 'Georgia', 'Impact', 'Lucida Console', 'Tahoma', 'Times New Roman', 'Verdana']"></dxi-item>
                      <dxi-item formatName="separator"></dxi-item>
                      <dxi-item formatName="bold"></dxi-item>
                      <dxi-item formatName="italic"></dxi-item>
                     
                      <dxi-item formatName="header" [formatValues]="[false, 1, 2, 3, 4, 5]"></dxi-item>
                      <dxi-item formatName="separator"></dxi-item>
                      <dxi-item formatName="orderedList"></dxi-item>
                      <dxi-item formatName="bulletList"></dxi-item>
                      <dxi-item formatName="separator"></dxi-item>
                      <dxi-item formatName="color"></dxi-item>
                      <dxi-item formatName="link"></dxi-item>
                      <dxi-item formatName="image"></dxi-item>
                      <dxi-item formatName="separator"></dxi-item>
                      <dxi-item formatName="clear"></dxi-item>
                  </dxo-toolbar>
                  <dxo-media-resizing
                      [enabled]=true>
                  </dxo-media-resizing>
                  
              </dx-html-editor>
          </div>
        
          <div class="col-lg-12">
            <label class="control-label">Sent On</label>

            <dx-text-box formControlName="sent_on" readOnly=true  placeholder="" >
            </dx-text-box>
          </div>
          
    </div>
    </form>
  </div>
</dx-popup>


<dx-popup class="popup" [width]="funcpopWidth(80)" [height]="450" [showTitle]="true" title="Preview Application Due for Renewal"
  [dragEnabled]="false" [closeOnOutsideClick]="true" [(visible)]="isViewApplicationDueforRenewal">

  <div *dxTemplate="let data of 'content'" style="background:#fff;">
      <div class="row">
        <dx-data-grid class="table row-border hover div-backwhite" [height]= 380 [columnHidingEnabled]="false" [dataSource]="app_renewalduenotificationsdetails"
        [showBorders]="true" [allowColumnResizing]="true" keyExpr="id">
        <dxo-filter-row [visible]="false"></dxo-filter-row>
        <dxo-load-panel [enabled]="true">
        </dxo-load-panel>
        <dxo-paging [enabled]="true">
        </dxo-paging>
        <dxo-pager [showPageSizeSelector]="true" [allowedPageSizes]="[10, 20]" [showNavigationButtons]="true" [showInfo]="true"
          infoText="Page #{0}. Total: {1} ({2} items)">
        </dxo-pager>
        <dxo-search-panel [visible]="true">
        </dxo-search-panel>
        <dxo-export [enabled]="true" fileName="ProductApplications" [allowExportSelectedData]="true"></dxo-export>
  
        <dxo-selection mode="single"></dxo-selection>
        <dxi-column  dataField="module_name"></dxi-column>
        <dxi-column dataField="certificate_no"></dxi-column>
        <dxi-column  dataField="expiry_date"></dxi-column>
        <dxi-column width=200  dataField="days_span" caption= "Remaining Days to Expiry"></dxi-column>
       
        <dxo-grouping #expand [autoExpandAll]="true"></dxo-grouping>
      </dx-data-grid> 
      </div>
  </div>
</dx-popup>



<dx-popup class="popup" [width]="funcpopWidth(85)" 
[showCloseButton]= "false" [height]="700" [showTitle]="true" title="Complet Account Registration"
  [dragEnabled]="true" [closeOnOutsideClick]="false" [(visible)]="is_trader_accountupdate">
  <div *dxTemplate="let data of 'content'">
      <dx-scroll-view>
          <div class="row col-lg-12">
            <wizard navBarLayout ="large-filled-symbols" style="background: #fff !important; height: 100% !important;">
              <wizard-step  navigationSymbol="Step 1"   stepTitle="Account Information" class="wizardStep-height">
                <form enctype="multipart/form-data" role="form" [formGroup]="trader_profile" >
                  <div class="row div-nopadding col-lg-12">
                    <div class="col-xs-12 col-md-6 col-lg-6 col-xl-4">
                      <label class="control-label">Account Type</label>
                      <dx-select-box [dataSource]="accountTypesData" valueExpr="id" displayExpr="name" placeholder="Select Account Type"
                         [searchEnabled]="true" formControlName="traderaccount_type_id">
                      </dx-select-box>
                    </div>
                    <div class="col-xs-12 col-md-6 col-lg-6 col-xl-4">
                
                      <label class="control-label">Trader Name</label>
                
                      <dx-text-box formControlName="name" placeholder="Trader Name">
                      </dx-text-box>
                    </div>
                    <div class="col-xs-12 col-md-6 col-lg-6 col-xl-4">
                      <label for="ti" class="control-label">Email Address</label>
                      <dx-text-box  formControlName="email" placeholder="Email Address">
                      </dx-text-box>
                    </div>
                    
                    <div class="col-xs-12 col-md-6 col-lg-6 col-xl-4">
                      <label class="control-label">Country</label>
                
                      <dx-select-box [dataSource]="countries"   valueExpr="id" displayExpr="name" placeholder="Select Country"
                        (onSelectionChanged)="onCoutryCboSelect($event)" [searchEnabled]="true" formControlName="country_id">
                      </dx-select-box>
                    </div>
                   
                    <div class="col-xs-12 col-md-6 col-lg-6 col-xl-4">
                      <label class="control-label">Province/Region/City</label>
                
                      <dx-select-box [dataSource]="regions"   valueExpr="id" displayExpr="name" (onSelectionChanged)="onRegionsCboSelect($event)"
                        [searchEnabled]="true" formControlName="region_id">
                      </dx-select-box>
                    </div>
                    <div class="col-xs-12 col-md-6 col-lg-6 col-xl-4">
                      <label for="ti" class="control-label">District(Optional)</label>
                
                      <dx-select-box [dataSource]="districts"  valueExpr="id" placeholder="Select District" displayExpr="name"
                        [searchEnabled]="true" formControlName="district_id">
                      </dx-select-box>
                    </div>
                
                    <div class="col-xs-12 col-md-6 col-lg-6 col-xl-4">
                      <label for="ti" class="control-label">Postal  Address</label>
                      <dx-text-box formControlName="postal_address" placeholder="Postal Address">
                      </dx-text-box>
                    </div>
                    <div class="col-xs-12 col-md-6 col-lg-6 col-xl-4">
                      <label for="ti" class="control-label">Telephone No</label>
                
                      <dx-text-box formControlName="telephone_no"  placeholder="Telephone No">
                      </dx-text-box>
                    </div>
                    <div class="col-xs-12 col-md-6 col-lg-6 col-xl-4">
                      <label class="control-label col-lg-12">Mobile No</label>
                
                      <dx-text-box formControlName="mobile_no"  placeholder="Mobile No">
                      </dx-text-box>
                    </div>
                    <div class="col-xs-12 col-md-6 col-lg-6 col-xl-4 " *ngIf="isTPinNumberEnabled">
                      <label for="ti" class="control-label col-lg-12">TPIN No</label>
                
                      <dx-text-box formControlName="tpn_no"  [readOnly]= "isReadOnly" placeholder="TPIN NO">
                      </dx-text-box>
                
                    </div>
                    <div class="col-xs-12 col-md-6 col-lg-6 col-xl-4 " *ngIf="isPacroNumberEnabled">
                      <label for="ti" class="control-label col-lg-12">Pacra No(Company)</label>
                      <dx-text-box formControlName="pacra_no"  [readOnly]= "isReadOnly" placeholder="Pacra No">
                      </dx-text-box>
                    </div>
                    <div class="col-lg-12">
                      <label class="control-label">Physical Address</label>
                
                      <dx-text-area [height]="60" formControlName="physical_address"  placeholder="Physical Address">
                      </dx-text-area>
                    </div>
                    <p></p>
                    <div class="col-xs-12 col-md-6 col-lg-6 col-xl-4">
                      <label class="control-label">Contact Person</label>
                      <dx-text-box formControlName="contact_person"  placeholder="Contact Person">
                      </dx-text-box>
                    </div>
                    <div class="col-xs-12 col-md-6 col-lg-6 col-xl-4">
                      <label class="control-label">Contact Person Email </label>
                      <dx-text-box formControlName="contact_person_email"   placeholder="Contact Person Email">
                      </dx-text-box>
                    </div>
                    <div class="col-xs-12 col-md-6 col-lg-6 col-xl-4">
                      <label class="control-label">Contact Person Telephone </label>
                      <dx-text-box formControlName="contact_person_telephone" placeholder="Contact Person Telephone">
                      </dx-text-box>
                    </div>
                    <input type="hidden"  formControlName="id"/>
                  </div>  
                  <div class="col-lg-12 btn-margin-5">
                    <dx-button
                      text="Update Account Registration Details && Next"
                      type="success"
                      icon="fa fa-save"
                      [disabled]="!trader_profile.valid"
                      [elementAttr]="{ id: 'elementId', class: 'pull-right'}"
                      (onClick)="onUpdateTraderAccount()">
                  </dx-button>
                </div>
                </form>
              </wizard-step>
              <wizard-step  navigationSymbol="Step 2"   stepTitle="Documents Uploads" class="wizardStep-height">
                <div class="wizard-divtop">
                  <button type="button" class="btn btn-primary" previousStep><i class="fa fa-angle-double-left"></i>Account Information</button>
                  <button type="button" class="btn btn-primary"
                  nextStep>Next
                    Account Registration Submission<i class="fa fa-angle-double-right"></i></button>
        
                 </div>
                <div class=" wizard-content">
                  <app-application-documents [customer_account_id] ="customer_account_id"  [document_type_id] ="document_type_id" [status_id] ="status_id" [sub_module_id] ="sub_module_id" [module_id] ="module_id"></app-application-documents>
                </div>
                <div class="wizard-divbottom">
                  <button type="button" class="btn btn-primary" previousStep><i class="fa fa-angle-double-left"></i>Account Information</button>
                  <button type="button" class="btn btn-primary"
                  nextStep>Next
                  Account Registration Submission<i class="fa fa-angle-double-right"></i></button>
        
                </div>
              </wizard-step>
              <wizard-step  navigationSymbol="Completion"   stepTitle="Completion" class="wizardStep-height">
                    <form [formGroup]="onApplicationSubmissionFrm" class="col-lg-12 row div-nopadding wizard-content" style="background: #fff;" enctype="multipart/form-data" role="form" (ngSubmit)="onCustomerAccountRegistrationSubmission()">
                      <div class="col-lg-12">
                          <b><label>Declaration /Terms and condition</label></b>
                          <ul>
                            <p> I confirm that the information submitted as correct and valid, the institution may make enquiry on the details through the contact information provided.
                            </p>
                            <a>
                              Submission of the Information allows you to access Regulatory Services Provided by the Institution.
                            </a>
                          </ul>
                      </div>
                      
                      <div class="col-lg-12">
                        <dx-check-box text="Agree to the Declaration" [value]="undefined"
                          (onValueChanged)="submissionsTermscheckbox($event)">
                        </dx-check-box>
                      </div>
              
                      <div class="wizard-divbottom">
                        <button class="btn btn-primary" type="button" previousStep>Previous Step</button>
                        <button class="btn btn-primary" type="button" [disabled]="!termscheckbox"
                          (click)="onCustomerAccountRegistrationSubmission()">Complete Customer Account Registration </button>
                      </div>
            </form>


              </wizard-step>
            </wizard>
          </div>
      </dx-scroll-view>

  </div>
</dx-popup>